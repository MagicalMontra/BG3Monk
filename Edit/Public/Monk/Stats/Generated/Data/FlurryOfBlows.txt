new entry "MartialArtsFlurry"
type "PassiveData"
data "DisplayName" "Flurry of Blows"
data "Description" "Spend 1 Ki to make two unarmed strikes at the same target or different ones as a bonus action."
data "Icon" "Icon_Flurry_Monk"
data "Boosts" "IF(HasStatus('MARTS_DEX',context.Source)):UnlockSpell(Target_Flurry_Strike,,,,Dexterity);IF(HasStatus('MARTS_STR',context.Source)):UnlockSpell(Target_Flurry_Strike,,,,Strength)"

// Original
//data "Boosts" "IF(HasStatus('MARTS_DEX',context.Source)):UnlockSpell(Target_Flurry_Area,,,,Dexterity);IF(HasStatus('MARTS_DEX',context.Source)):UnlockSpell(Target_Flurry_Strike,,,,Dexterity);IF(HasStatus('MARTS_STR',context.Source)):UnlockSpell(Target_Flurry_Area,,,,Strength);IF(HasStatus('MARTS_STR',context.Source)):UnlockSpell(Target_Flurry_Strike,,,,Strength)"//

new entry "Target_Flurry_Area"
type "SpellData"
data "SpellType" "Target"
using "Target_UnarmedAttack"
data "TargetRadius" "Self()"
data "AreaRadius" "2"
data "MaximumTargets" "2"
data "SpellRoll" "Attack(AttackType.MeleeSpellAttack)"
data "SpellSuccess" "IF(not CharacterLevelGreaterThan(4) and HasStatus('MARTS_DEX',context.Source)):DealDamage(1d4+DexterityModifier,Bludgeoning);IF(CharacterLevelGreaterThan(4) and HasStatus('MARTS_DEX',context.Source)):DealDamage(ResourceRoll(MartialArtsDie,1) + DexterityModifier, Bludgeoning);IF(not CharacterLevelGreaterThan(4) and HasStatus('MARTS_STR',context.Source)):DealDamage(1d4+StrengthModifier,Bludgeoning);IF(CharacterLevelGreaterThan(4) and HasStatus('MARTS_STR',context.Source)):DealDamage(ResourceRoll(MartialArtsDie,1) + StrengthModifier, Bludgeoning)"
data "TargetConditions" "Enemy() and not Self() and not Dead()"
data "Icon" "Icon_Flurry_Two_Targets"
data "DisplayName" "Flurry of Blows - Two Targets"
data "Description" "Strike 2 targets in melee as a bonus action when you spend a Ki Point"
data "DescriptionParams" "DealDamage(1d4, Bludgeoning)"
data "ExtraDescription" "Hits up to 2 targets"
data "TooltipDamageList" "DealDamage(1d4, Bludgeoning)"
data "TooltipAttackSave" "MeleeSpellAttack"
data "PreviewCursor" "Melee"
data "CastTextEvent" "Cast"
data "CastSound" "Action_Cast_Bash"
data "TargetSound" "Action_Impact_Bash"
data "CycleConditions" "Character() and not Dead()"
data "UseCosts" "BonusActionPoint:1;KiPoint:1"
data "SpellFlags" "IsMelee;IsHarmful;IgnoreSilence"
data "HitAnimationType" "PhysicalDamage"
data "SpellAnimationIntentType" "Aggressive"
data "RequirementConditions" "HasActionResource('KiPoint', 1, 0, false)"

new entry "Target_Flurry_Strike"
type "SpellData"
data "SpellType" "Target"
data "Icon" "Icon_Flurry_Double_Strike"
data "TargetRadius" "1.5"
data "DisplayName" "Flurry of Blows"
data "Description" "Strike a target twice as a bonus action when you spend a Ki Point"
data "SpellProperties" "ApplyStatus(SELF,FLURRYSTRIKE,100,1)"
data "SpellRoll" "Attack(AttackType.MeleeSpellAttack)"
data "SpellSuccess" "IF(not CharacterLevelGreaterThan(4) and HasStatus('MARTS_DEX',context.Source)):DealDamage(1d4+DexterityModifier,Bludgeoning);IF(CharacterLevelGreaterThan(4) and HasStatus('MARTS_DEX',context.Source) and not CharacterLevelGreaterThan(10)):DealDamage(1d6+DexterityModifier,Bludgeoning);IF(CharacterLevelGreaterThan(10) and HasStatus('MARTS_DEX',context.Source) and not CharacterLevelGreaterThan(16)):DealDamage(1d8+DexterityModifier,Bludgeoning);IF(CharacterLevelGreaterThan(16) and HasStatus('MARTS_DEX',context.Source)):DealDamage(1d10+DexterityModifier,Bludgeoning);IF(not CharacterLevelGreaterThan(4) and HasStatus('MARTS_STR',context.Source)):DealDamage(1d4+StrengthModifier,Bludgeoning);IF(CharacterLevelGreaterThan(4) and HasStatus('MARTS_STR',context.Source) and not CharacterLevelGreaterThanLessThan(10)):DealDamage(1d6+StrengthModifier,Bludgeoning);IF(CharacterLevelGreaterThan(10) and HasStatus('MARTS_STR',context.Source) and not CharacterLevelGreaterThan(16)):DealDamage(1d8+StrengthModifier,Bludgeoning);IF(CharacterLevelGreaterThan(16) and HasStatus('MARTS_STR',context.Source)):DealDamage(1d10+StrengthModifier,Bludgeoning)"
data "SpellFail" ""
data "TargetConditions" "not Self() and not Dead()"
data "DescriptionParams" "DealDamage(1d4, Bludgeoning)"
data "TooltipDamageList" "DealDamage(1d4, Bludgeoning)"
data "TooltipAttackSave" "MeleeSpellAttack"
data "CastTextEvent" "Cast"
data "UseCosts" "BonusActionPoint:1;KiPoint:1"
data "SpellAnimation" "2ba949b7-0329-4190-992c-11b0d29183c5(CMBT_Skill_Precision_01_Prepare),,;9583ecee-cf6c-4735-86db-7ebf1df15eae(CMBT_Skill_Precision_01_Antic),,;de006e3f-70fb-4eb7-a98d-d845d15b20e8(CMBT_Skill_Precision_01_Attack),,;50696db7-d931-4734-915d-32d038ba99a5(CMBT_Skill_Precision_01_Recover),,;a0503ad0-c1b1-449c-b431-4ac6c39c58d7(CMBT_Skill_Precision_01_Loop),,;c36ed247-2272-492b-99c2-2ca10b014670(CMBT_Skill_Precision_01_Dash),,"
data "SpellFlags" "IsAttack;IsHarmful;IgnoreSilence"
data "RequirementConditions" "HasActionResource('KiPoint', 1, 0, false)"

// data "Description" "Strike the target twice as a bonus action when you spend a Ki Point"//

new entry "FLURRYSTRIKE"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "Flurry Strike"
data "Description" "Flurry Strike"
data "Icon" "Icon_Monk_Strike"
data "StackId" "FLURRYSTRIKE"
data "Boosts" "UnlockSpell(Target_MartialArts_FreeBonusAttack)"

new entry "Target_MartialArts_FreeBonusAttack"
type "SpellData"
data "SpellType" "Target"
data "Level" "1"
data "TargetCeiling" "0"
data "TargetFloor" ".25"
data "TargetRadius" "1.5"
data "SpellProperties" "RemoveStatus(SELF,FLURRYSTRIKE);RemoveStatus(SELF,HEALINGFLURRY)"
data "SpellRoll" "Attack(AttackType.MeleeSpellAttack)"
data "SpellSuccess" "IF(not CharacterLevelGreaterThan(4) and HasStatus('MARTS_DEX',context.Source)):DealDamage(1d4+DexterityModifier,Bludgeoning);IF(CharacterLevelGreaterThan(4) and HasStatus('MARTS_DEX',context.Source) and not CharacterLevelGreaterThan(10)):DealDamage(1d6+DexterityModifier,Bludgeoning);IF(CharacterLevelGreaterThan(10) and HasStatus('MARTS_DEX',context.Source) and not CharacterLevelGreaterThan(16)):DealDamage(1d8+DexterityModifier,Bludgeoning);IF(CharacterLevelGreaterThan(16) and HasStatus('MARTS_DEX',context.Source)):DealDamage(1d10+DexterityModifier,Bludgeoning);IF(not CharacterLevelGreaterThan(4) and HasStatus('MARTS_STR',context.Source)):DealDamage(1d4+StrengthModifier,Bludgeoning);IF(CharacterLevelGreaterThan(4) and HasStatus('MARTS_STR',context.Source) and not CharacterLevelGreaterThanLessThan(10)):DealDamage(1d6+StrengthModifier,Bludgeoning);IF(CharacterLevelGreaterThan(10) and HasStatus('MARTS_STR',context.Source) and not CharacterLevelGreaterThan(16)):DealDamage(1d8+StrengthModifier,Bludgeoning);IF(CharacterLevelGreaterThan(16) and HasStatus('MARTS_STR',context.Source)):DealDamage(1d10+StrengthModifier,Bludgeoning)"
data "TargetConditions" "not Self() and not Dead()"
data "Icon" "Icon_Monk_Strike"
data "DisplayName" "Monk Unarmed Strike"
data "Description" "Your unarmed strikes use your Dexterity modifier., at higher levels the damage die increases"
data "DescriptionParams" "DealDamage(1d4+MeleeWeaponAttackModifier, Bludgeoning)"
data "TooltipDamageList" "DealDamage(1d4+MeleeWeaponAttackModifier, Bludgeoning)"
data "TooltipAttackSave" "MeleeSpellAttack"
data "PreviewCursor" "Melee"
data "CastTextEvent" "Cast"
data "CastSound" "Action_Cast_Bash"
data "TargetSound" "Action_Impact_Bash"
data "CycleConditions" "Character() and not Dead()"
data "UseCosts" ""
data "SpellAnimation" "8b8bb757-21ce-4e02-a2f3-97d55cf2f90b(CMBT_Melee_RHand_01_Prepare),,;6606c30b-be1c-4f17-ae6b-1a591c80b18c(CMBT_Melee_RHand_01_Antic),366693ee-d97f-4294-a4dd-a2145ddc4e6a(CMBT_Melee_RHand_01_Antic_LOW),9f2d32b9-529a-4b75-b3df-6e1ae1395280(CMBT_Melee_RHand_01_Antic_HIGH);f4ac302b-1569-404f-bd52-1fe443e265df(CMBT_Melee_RHand_01_Attack),479ee5da-2967-41e1-b7d1-a94e864a5f25(CMBT_Melee_RHand_01_Attack_LOW),79323098-edb3-4993-ba50-9b5f705e9878(CMBT_Melee_RHand_01_Attack_HIGH);e8a5c57f-855b-4227-acaa-11e8ce8d7d64(CMBT_Melee_RHand_01_Recover),b5cb923d-0c08-4c20-89a9-44b9bf98c6cb(CMBT_Melee_RHand_01_Recover_LOW),6282d127-0c06-4365-9d53-6f32ef350127(CMBT_Melee_RHand_01_Recover_HIGH);7bb52cd4-0b1c-4926-9165-fa92b75876a3(CMBT_Melee_RHand_01_Loop),,;2b81c18b-9698-4262-a623-932c2bb1296d(CMBT_Melee_RHand_01_Dash),ecbf9949-3b33-432c-b735-e47aaed0924a(CMBT_Melee_RHand_01_Dash_LOW),e71a7c08-fdc1-4a0b-9a90-1c793c58553c(CMBT_Melee_RHand_01_Dash_HIGH)"
data "SpellFlags" "IsAttack;IsMelee;IsHarmful;DontForceSheathOrUnsheath;IgnoreSilence"
data "HitAnimationType" "PhysicalDamage"
data "SpellAnimationIntentType" "Aggressive"


new entry "Projectile_Flurry"
type "SpellData"
data "SpellType" "Projectile"
data "SpellRoll" "Attack(AttackType.MeleeSpellAttack)"
data "SpellSuccess" "IF(not CharacterLevelGreaterThan(4) and HasStatus('MARTS_DEX',context.Source)):DealDamage(1d4+DexterityModifier,Bludgeoning);IF(CharacterLevelGreaterThan(4) and HasStatus('MARTS_DEX',context.Source)):DealDamage(ResourceRoll(MartialArtsDie,1) + DexterityModifier, Bludgeoning);IF(not CharacterLevelGreaterThan(4) and HasStatus('MARTS_STR',context.Source)):DealDamage(1d4+StrengthModifier,Bludgeoning);IF(CharacterLevelGreaterThan(4) and HasStatus('MARTS_STR',context.Source)):DealDamage(ResourceRoll(MartialArtsDie,1) + StrengthModifier, Bludgeoning)"
data "TargetConditions" "Character() and Enemy()"
data "ExplodeRadius" "1"
data "Template" "ff93ba9c-124c-454e-ac8c-436c136bcef2"
data "CastTextEvent" "Cast"
data "SpellAnimation" "2ba949b7-0329-4190-992c-11b0d29183c5(CMBT_Skill_Precision_01_Prepare),,;9583ecee-cf6c-4735-86db-7ebf1df15eae(CMBT_Skill_Precision_01_Antic),,;de006e3f-70fb-4eb7-a98d-d845d15b20e8(CMBT_Skill_Precision_01_Attack),,;50696db7-d931-4734-915d-32d038ba99a5(CMBT_Skill_Precision_01_Recover),,;a0503ad0-c1b1-449c-b431-4ac6c39c58d7(CMBT_Skill_Precision_01_Loop),,;c36ed247-2272-492b-99c2-2ca10b014670(CMBT_Skill_Precision_01_Dash),,"
new entry "TouchOfDeath"
type "PassiveData"
data "DisplayName" "Touch of Death"
data "Description" "When you reduce a creature to 0HP with a melee attack, you gain temporary HP equal to WisdomModifier+Level."
data "DescriptionParams" "RegainHitPoints(0);RegainHitPoints(WisdomModifier+Level)"
data "Icon" "Status_DarkOnes_Blessing"
data "Conditions" "HasHPLessThan(1) and IsMeleeAttack() and Character()"
data "StatsFunctors" "IF(HasStatus('TOUCH_OF_DEATH',context.Source)):ApplyStatus(SELF,TOUCH_OF_DEATH2,100,1);IF(not HasStatus('TOUCH_OF_DEATH',context.Source)):ApplyStatus(SELF,TOUCH_OF_DEATH,100,-1);ApplyStatus(PASSIVE_TOUCH_OF_DEATH,100,0);"
data "StatsFunctorContext" "OnDamage"

new entry "TOUCH_OF_DEATH"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "Touch of Death Status1" 
data "Description" "When you reduce a creature to 0HP with a melee attack, you gain temporary HP equal to WisdomModifier+Level."
data "Icon" "Status_DarkOnes_Blessing"
data "SoundStart" "Spell_Passive_Impact_Damage_DarkOnesBlessing_L1to3"
data "StackId" "TEMPORARY_HP1"
data "Boosts" "IF(ConditionResult(context.Source.Wisdom > 9)):TemporaryHP(WisdomModifier+Level);IF(not ConditionResult(context.Source.Wisdom > 9)):TemporaryHP(Level)"
data "RemoveConditions" "not HasTemporaryHP()"
data "RemoveEvents" "OnDamage"
data "OnApplyFunctors" "RemoveStatus(SELF,TOUCH_OF_DEATH2)"
data "ApplyEffect" "3a76f32b-1b84-4298-90c6-7e430cb9f98b"
data "StatusPropertyFlags" "DisableCombatLog;DisablePortraitIndicator;DisableOverhead"

new entry "TOUCH_OF_DEATH2"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "Touch of Death Status2" 
data "Description" "When you reduce a creature to 0HP with a melee attack, you gain temporary HP equal to WisdomModifier+Level."
data "Icon" "Status_DarkOnes_Blessing"
data "SoundStart" "Spell_Passive_Impact_Damage_DarkOnesBlessing_L1to3"
data "StackId" "TEMPORARY_HP"
data "OnApplyFunctors" "RemoveStatus(SELF,TOUCH_OF_DEATH)"
data "OnRemoveFunctors" "ApplyStatus(SELF,TOUCH_OF_DEATH)"
data "ApplyEffect" "3a76f32b-1b84-4298-90c6-7e430cb9f98b"
data "StatusPropertyFlags" "DisableCombatLog;DisablePortraitIndicator;DisableOverhead"

new entry "PASSIVE_TOUCH_OF_DEATH"
type "StatusData"
data "StatusType" "EFFECT"
using "_PASSIVES"
data "DisplayName" "Passive Touch of Death Status"
data "Icon" "Status_DarkOnes_Blessing"
data "StatusPropertyFlags" "ApplyToDead;DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "StatusEffect" "54420b48-840e-49f3-a458-f524a4efaffa"

new entry "HourOfReaping"
type "PassiveData"
data "DisplayName" "Hour of Reaping"
data "Description" "As an Action you can cause all enemies within 30ft of you who can see you to make a Wisdom saving throw or be frightened of you for 1 round."
data "Icon" "Icon_HorrificVisage"
data "Boosts" "UnlockSpell(Shout_HourOfReaping)"

new entry "Shout_HourOfReaping"
type "SpellData"
data "SpellType" "Shout"
data "Cooldown" "OncePerTurn"
data "SpellProperties" "ApplyStatus(FEARED,100,1)"
data "AreaRadius" "10"
data "TargetConditions" "not Ally() and Character() and not Self() and not Dead()"
data "Icon" "Icon_HorrificVisage"
data "DisplayName" "Hour of Reaping"
data "Description" "Cause all enemies within 30ft of you who can see you to make a Wisdom saving throw or be frightened of you for 1 round."
data "DescriptionParams" "ApplyStatus(FEARED,100,1)"
data "TooltipAttackSave" "Wisdom"
data "TooltipStatusApply" "ApplyStatus(FEARED,100,1)"
data "CastTextEvent" "Cast"
data "CastSound" "Spell_Cast_Tadpole_HorrificVisage_L1to3"
data "UseCosts" "ActionPoint:1"
data "SpellAnimation" "f94542d9-a79c-478a-92de-573cead9260e(TAD_PsionicPull_01_Prepare),,;,,;c424155d-d04b-434d-a8f6-3abf10a55f88(TAD_HorrificVisage_01_Cast),,;96c3f29a-d401-4b8e-8a3e-f9d523b8de23(TAD_HorrificVisage_01_Recover),,;bd339475-d2b5-46e8-8d0c-9f2ad6a91328(TAD_PsionicPull_01_Loop),,;,,"
data "VerbalIntent" "Damage"
data "SpellFlags" "IsHarmful;IgnoreSilence;"
data "CastEffect" "2cc72eb7-b8bf-4f53-8a05-23c55fa5b6ff"

new entry "MasteryOfDeath"
type "PassiveData"
data "DisplayName" "Mastery of Death"
data "Description" "When reduced to 0HP spend 1 Ki to have 1 HP instead. This doesn't cost an action."
data "Icon" "TadpoleSuperPower_SurvivalInstinct"
data "Properties" "IsToggled;ToggledDefaultAddToHotbar"
data "ToggleOnFunctors" "ApplyStatus(SELF,MASTERYOFDEATH_TOGGLE,100,-1)"
data "ToggleOffFunctors" "RemoveStatus(SELF,MASTERYOFDEATH_TOGGLE);RemoveStatus(SELF,MASTERYOFDEATH_DOWNED);RemoveStatus(SELF,MASTERYOFDEATH)"

new entry "MASTERYOFDEATH_TOGGLE"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "Mastery of Death"
data "Description" "When reduced to 0HP spend 1 Ki to have 1 HP instead. This doesn't cost an action."
data "Icon" "TadpoleSuperPower_SurvivalInstinct"
data "SoundLoop" "Spell_Status_SurvivalInstinct_MO"
data "StackId" "MASTERYOFDEATH_TOGGLE"
data "TickFunctors" "ApplyStatus(MASTERYOFDEATH,100,-1)"
data "OnApplyFunctors" "IF(HasActionResource('KiPoint', 1, 0, false), context.Source):ApplyStatus(MASTERYOFDEATH,100,-1)"

new entry "MASTERYOFDEATH"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "Mastery of Death"
data "Description" "When reduced to 0HP spend 1 Ki to have 1 HP instead. This doesn't cost an action."
data "Icon" "TadpoleSuperPower_SurvivalInstinct"
data "SoundLoop" "Spell_Status_SurvivalInstinct_MO"
data "StackId" "MASTERYOFDEATH"
data "Boosts" "DownedStatus(MASTERYOFDEATH_DOWNED)"
data "StatusEffect" "d5fe7316-c6e2-483f-9e9f-e7a8035c1b03"

new entry "MASTERYOFDEATH_DOWNED"
type "StatusData"
data "StatusType" "DOWNED"
using "DOWNED"
data "DisplayName" "Mastery of Death"
data "Description" "When reduced to 0HP spend 1 Ki to have 1 HP instead(no action)."
data "Icon" "TadpoleSuperPower_SurvivalInstinct"
data "Conditions" "HasActionResource('KiPoint', 1, 0, false, context.Source)"
data "AnimationStart" "7e811df9-74e7-4515-bd02-7043164dbf33(STAT_Fallen_Peace_01_Start)"
data "AnimationLoop" "d7b7cf53-fe71-4a23-8011-9675a6e1d902(STAT_Fallen_Peace_01_Loop)"
data "AnimationEnd" "ade4cf7f-a34a-40c4-b810-096f0c186bc2(STAT_Fallen_Peace_01_End)"
data "StatusPropertyFlags" "DisableCombatlog;DisablePortraitIndicator;ForceSheathed"
data "OnApplyFunctors" "RemoveStatus(MASTERYOFDEATH);RegainHitPoints(1);UseActionResource(KiPoint,1)"
data "ApplyEffect" "f9399640-8e60-49b6-b8a9-49e5ad9207f8"
